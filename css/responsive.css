/**
 * NexusAI Glassmorphism 2026 - Responsive
 * 響應式斷點與工具類
 */

/* ========================================
   斷點定義
   xs: 320px (小型手機)
   sm: 480px (大型手機)
   md: 768px (平板)
   lg: 1024px (小型桌機)
   xl: 1280px (桌機)
   2xl: 1536px (大型桌機)
   ======================================== */

/* ========================================
   無障礙 - Skip Link
   ======================================== */

.skip-link {
  position: absolute;
  top: -100%;
  left: var(--space-4);
  padding: var(--space-3) var(--space-6);
  background: var(--color-primary);
  color: white;
  font-weight: var(--font-medium);
  border-radius: var(--radius-md);
  z-index: 9999;
  text-decoration: none;
  transition: top var(--duration-200) var(--ease-smooth);
}

.skip-link:focus {
  top: var(--space-4);
}

/* ========================================
   焦點樣式（無障礙）
   ======================================== */

/* 可見焦點指示器 */
:focus-visible {
  outline: 2px solid var(--color-primary);
  outline-offset: 2px;
}

/* 移除預設 outline（僅限有自訂焦點樣式時） */
:focus:not(:focus-visible) {
  outline: none;
}

/* 高對比模式 */
@media (prefers-contrast: high) {
  .glass-card,
  .glass-btn,
  .glass-nav,
  .glass-sidebar {
    border-width: 2px;
    border-color: var(--text-primary);
  }

  .btn--primary {
    background: var(--text-primary);
    color: var(--bg-primary);
  }
}

/* ========================================
   Reduced Motion（減少動畫偏好）
   ======================================== */

@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }

  .float,
  .spin,
  .bounce,
  .pulse {
    animation: none !important;
  }

  .hover-lift:hover,
  .hover-scale:hover,
  .hover-bounce:hover {
    transform: none !important;
  }
}

/* ========================================
   顯示/隱藏工具類
   ======================================== */

/* 手機隱藏，桌面顯示 */
.hidden-mobile {
  display: none;
}

@media (min-width: 768px) {
  .hidden-mobile {
    display: block;
  }
}

/* 桌面隱藏，手機顯示 */
.hidden-desktop {
  display: block;
}

@media (min-width: 768px) {
  .hidden-desktop {
    display: none;
  }
}

/* 各斷點顯示/隱藏 */
@media (min-width: 640px) {
  .sm\:block { display: block; }
  .sm\:hidden { display: none; }
  .sm\:flex { display: flex; }
  .sm\:grid { display: grid; }
}

@media (min-width: 768px) {
  .md\:block { display: block; }
  .md\:hidden { display: none; }
  .md\:flex { display: flex; }
  .md\:grid { display: grid; }
}

@media (min-width: 1024px) {
  .lg\:block { display: block; }
  .lg\:hidden { display: none; }
  .lg\:flex { display: flex; }
  .lg\:grid { display: grid; }
}

@media (min-width: 1280px) {
  .xl\:block { display: block; }
  .xl\:hidden { display: none; }
  .xl\:flex { display: flex; }
  .xl\:grid { display: grid; }
}

/* ========================================
   響應式網格
   ======================================== */

@media (min-width: 640px) {
  .sm\:grid-cols-2 { grid-template-columns: repeat(2, 1fr); }
  .sm\:grid-cols-3 { grid-template-columns: repeat(3, 1fr); }
}

@media (min-width: 768px) {
  .md\:grid-cols-2 { grid-template-columns: repeat(2, 1fr); }
  .md\:grid-cols-3 { grid-template-columns: repeat(3, 1fr); }
  .md\:grid-cols-4 { grid-template-columns: repeat(4, 1fr); }
}

@media (min-width: 1024px) {
  .lg\:grid-cols-2 { grid-template-columns: repeat(2, 1fr); }
  .lg\:grid-cols-3 { grid-template-columns: repeat(3, 1fr); }
  .lg\:grid-cols-4 { grid-template-columns: repeat(4, 1fr); }
  .lg\:grid-cols-5 { grid-template-columns: repeat(5, 1fr); }
}

/* ========================================
   響應式 Flexbox
   ======================================== */

@media (min-width: 768px) {
  .md\:flex-row { flex-direction: row; }
  .md\:flex-col { flex-direction: column; }
  .md\:items-center { align-items: center; }
  .md\:justify-between { justify-content: space-between; }
}

@media (min-width: 1024px) {
  .lg\:flex-row { flex-direction: row; }
  .lg\:flex-col { flex-direction: column; }
}

/* ========================================
   響應式間距
   ======================================== */

@media (min-width: 640px) {
  .sm\:p-6 { padding: var(--space-6); }
  .sm\:p-8 { padding: var(--space-8); }
  .sm\:gap-6 { gap: var(--space-6); }
}

@media (min-width: 768px) {
  .md\:p-6 { padding: var(--space-6); }
  .md\:p-8 { padding: var(--space-8); }
  .md\:px-8 { padding-left: var(--space-8); padding-right: var(--space-8); }
  .md\:gap-6 { gap: var(--space-6); }
  .md\:gap-8 { gap: var(--space-8); }
}

@media (min-width: 1024px) {
  .lg\:p-8 { padding: var(--space-8); }
  .lg\:p-12 { padding: var(--space-12); }
  .lg\:gap-8 { gap: var(--space-8); }
}

/* ========================================
   響應式文字大小
   ======================================== */

@media (min-width: 768px) {
  .md\:text-lg { font-size: var(--text-lg); }
  .md\:text-xl { font-size: var(--text-xl); }
  .md\:text-2xl { font-size: var(--text-2xl); }
}

@media (min-width: 1024px) {
  .lg\:text-xl { font-size: var(--text-xl); }
  .lg\:text-2xl { font-size: var(--text-2xl); }
  .lg\:text-3xl { font-size: var(--text-3xl); }
}

/* ========================================
   響應式寬度
   ======================================== */

.w-full { width: 100%; }
.w-auto { width: auto; }

@media (min-width: 768px) {
  .md\:w-auto { width: auto; }
  .md\:w-1\/2 { width: 50%; }
  .md\:w-1\/3 { width: 33.333333%; }
}

@media (min-width: 1024px) {
  .lg\:w-auto { width: auto; }
  .lg\:w-1\/2 { width: 50%; }
  .lg\:w-1\/3 { width: 33.333333%; }
  .lg\:w-1\/4 { width: 25%; }
}

/* ========================================
   Bento Grid 響應式（手機回退）
   ======================================== */

/* 手機上取消 span，全部單列 */
@media (max-width: 767px) {
  .bento-grid {
    grid-template-columns: 1fr !important;
    grid-auto-rows: auto !important;
  }

  .bento-grid [style*="grid-column: span 2"],
  .bento-grid [style*="grid-row: span 2"],
  .bento-grid .bento-item--large,
  .bento-grid .bento-item--wide {
    grid-column: span 1 !important;
    grid-row: span 1 !important;
  }
}

/* ========================================
   Dashboard/內頁響應式
   ======================================== */

/* 圖表區域手機優化 */
@media (max-width: 640px) {
  .card-grid {
    grid-template-columns: 1fr !important;
  }

  .card-grid[style*="minmax(400px"],
  .card-grid[style*="minmax(350px"] {
    grid-template-columns: 1fr !important;
  }
}

/* 側邊欄佈局手機優化 */
@media (max-width: 1024px) {
  .sidebar-layout__main {
    padding: var(--space-4);
  }

  /* 平板/手機：固定「開啟選單」按鈕在左上角，避免跟著 off-canvas sidebar 一起被移出畫面 */
  [data-mobile-sidebar-toggle] {
    display: flex !important;
    position: fixed !important;
    top: calc(var(--space-3) + env(safe-area-inset-top, 0px));
    right: var(--space-3);
    left: auto;
    z-index: calc(var(--z-fixed) + 10);
    transform: none !important;
    visibility: visible !important;
    opacity: 1 !important;
  }

  /* Settings：平板/手機改單欄，避免左側內部導航擠壓內容 */
  .settings-layout {
    grid-template-columns: 1fr;
  }

  /* 內部導航改為三欄按鈕列（較不佔高度，且維持可點擊區域） */
  .settings-nav .glass-card {
    display: grid;
    grid-template-columns: repeat(3, minmax(0, 1fr));
    gap: var(--space-2);
  }

  .settings-nav-item {
    justify-content: center;
    padding: var(--space-3);
  }

  .settings-nav-item svg {
    display: none;
  }

  /* Billing：小螢幕讓方案卡與付款卡更好排版 */
  .plan-header {
    flex-direction: column;
    align-items: flex-start;
  }

  .plan-price {
    text-align: left;
  }

  .payment-card {
    grid-template-columns: 40px 1fr;
  }

  .payment-actions {
    grid-column: 1 / -1;
    justify-content: flex-end;
  }
}

@media (max-width: 640px) {
  .sidebar-layout__main {
    padding: var(--space-3);
  }

  /* 頁面標題手機優化 */
  .page-header > .flex {
    flex-direction: column;
    align-items: stretch !important;
  }

  /* 讓語言/主題按鈕永遠在右側且維持橫排 */
  .page-header > .flex > .flex {
    align-self: flex-end;
    justify-content: flex-end;
  }

  .page-header .h3 {
    font-size: var(--text-xl);
  }
}

/* ========================================
   Hero 響應式
   ======================================== */

@media (max-width: 768px) {
  .hero__shape--1 {
    width: 150px !important;
    height: 150px !important;
  }

  .hero__shape--2 {
    width: 100px !important;
    height: 100px !important;
  }

  .hero__shape--3 {
    width: 80px !important;
    height: 80px !important;
  }
}

/* ========================================
   表格響應式（堆疊式）
   ======================================== */

@media (max-width: 640px) {
  .table-stack thead {
    display: none;
  }

  .table-stack tbody tr {
    display: block;
    margin-bottom: var(--space-4);
    padding: var(--space-4);
    background: var(--glass-bg);
    border-radius: var(--radius-md);
    border: 1px solid var(--border-default);
  }

  .table-stack tbody td {
    display: flex;
    justify-content: space-between;
    padding: var(--space-2) 0;
    border-bottom: 1px solid var(--border-muted);
  }

  .table-stack tbody td::before {
    content: attr(data-label);
    font-weight: var(--font-medium);
    color: var(--text-secondary);
  }

  .table-stack tbody td:last-child {
    border-bottom: none;
  }
}

/* ========================================
   觸控友好
   ======================================== */

@media (hover: none) and (pointer: coarse) {
  /* 觸控設備上的最小點擊區域 */
  .btn,
  .form-input,
  .glass-btn,
  .glass-input {
    min-height: 44px;
  }

  /* 禁用 hover 效果（可選） */
  .hover-lift:hover,
  .hover-scale:hover {
    transform: none;
  }
}

/* ========================================
   打印樣式
   ======================================== */

@media print {
  .no-print {
    display: none !important;
  }

  body {
    background: white;
    color: black;
  }

  .glass,
  .glass-card,
  .glass-nav,
  .glass-sidebar {
    background: white;
    backdrop-filter: none;
    -webkit-backdrop-filter: none;
    border: 1px solid #ccc;
  }
}

/* ========================================
   暗黑模式媒體查詢（系統偵測）
   ======================================== */

@media (prefers-color-scheme: dark) {
  :root:not([data-theme="light"]) {
    /* 如果沒有明確設定淺色主題，則跟隨系統 */
    /* 這裡的變數會被 design-tokens.css 中的 [data-theme="dark"] 覆蓋 */
  }
}

/* ========================================
   橫向模式
   ======================================== */

@media (orientation: landscape) and (max-height: 500px) {
  .section {
    padding: var(--space-8) 0;
  }
}

/* ========================================
   高 DPI 顯示
   ======================================== */

@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
  /* 高 DPI 設備可能需要更細的邊框 */
  .glass-card,
  .glass-nav {
    border-width: 0.5px;
  }
}
