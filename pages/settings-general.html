<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>一般設定 - NexusAI</title>

    <!-- Head Loader（集中管理核心 CSS/Fonts/版本號） -->
    <script src="../js/head-loader.js"></script>
</head>
<body>
    <!-- Skip Link (無障礙) -->
    <a href="#main-content" class="skip-link">跳至主要內容</a>

    <div class="sidebar-layout">
        <!-- Sidebar Container -->
        <nav id="sidebar-container" class="sidebar-layout__sidebar" aria-label="側邊導航"></nav>

        <!-- Main Content -->
        <main id="main-content" class="sidebar-layout__main main-content">
        <div class="container">
            <!-- Header -->
            <header class="page-header">
                <div class="flex items-center justify-between flex-wrap gap-4">
                    <div>
                        <h1 class="page-title" data-i18n="settings.title">設定</h1>
                        <p class="page-subtitle" data-i18n="settings.subtitle">管理您的帳號和偏好設定</p>
                    </div>
                    <div class="flex items-center gap-3">
                        <button class="btn btn--secondary btn--sm" data-lang-toggle aria-label="切換語言">
                            <span data-lang-display>中</span>
                        </button>
                        <button class="btn btn--secondary btn--sm" data-theme-toggle aria-label="切換主題">
                            <i data-lucide="moon" data-theme-icon></i>
                        </button>
                    </div>
                </div>
            </header>

            <div class="settings-layout">
                <!-- Settings Navigation -->
                <aside class="settings-nav">
                    <nav class="glass-card">
                        <a href="settings-general.html" class="settings-nav-item active">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <circle cx="12" cy="12" r="3" stroke-width="2"/>
                                <path d="M12 1v6m0 6v10M1 12h6m6 0h10" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                            <span data-i18n="settings.general">一般設定</span>
                        </a>
                        <a href="settings-billing.html" class="settings-nav-item">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <rect x="1" y="4" width="22" height="16" rx="2" stroke-width="2"/>
                                <path d="M1 10h22" stroke-width="2"/>
                            </svg>
                            <span data-i18n="settings.billing">帳單設定</span>
                        </a>
                        <a href="settings-security.html" class="settings-nav-item">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <rect x="3" y="11" width="18" height="11" rx="2" stroke-width="2"/>
                                <path d="M7 11V7a5 5 0 0 1 10 0v4" stroke-width="2"/>
                            </svg>
                            <span data-i18n="settings.security">安全設定</span>
                        </a>
                    </nav>
                </aside>

                <!-- Settings Content -->
                <div class="settings-content">
                    <!-- Personal Information -->
                    <section class="glass-card mb-6">
                        <h2 class="section-title" data-i18n="settings.personalInfo">個人資訊</h2>
                        <form class="settings-form">
                            <div class="form-group">
                                <label class="form-label" for="fullName" data-i18n="settings.fullName">全名</label>
                                <input type="text" id="fullName" class="form-input" value="張小明" placeholder="請輸入您的全名">
                            </div>

                            <div class="form-group">
                                <label class="form-label" for="email" data-i18n="settings.email">Email</label>
                                <input type="email" id="email" class="form-input" value="ming@example.com" placeholder="your@email.com">
                                <small class="form-help" data-i18n="settings.emailHelp">我們會將重要通知發送到此信箱</small>
                            </div>

                            <div class="form-group">
                                <label class="form-label" for="phone" data-i18n="settings.phone">手機號碼</label>
                                <input type="tel" id="phone" class="form-input" value="+886 912-345-678" placeholder="+886 912-345-678">
                            </div>

                            <div class="form-group">
                                <label class="form-label" for="company" data-i18n="settings.company">公司</label>
                                <input type="text" id="company" class="form-input" value="NexusAI Inc." placeholder="您的公司名稱">
                            </div>

                            <div class="form-group">
                                <label class="form-label" for="bio" data-i18n="settings.bio">簡介</label>
                                <textarea id="bio" class="form-input" rows="4" placeholder="簡單介紹您自己">全端工程師，專注於 AI 與 Web 開發。</textarea>
                            </div>

                            <div class="form-group">
                                <label class="form-label" for="avatar" data-i18n="settings.avatar">頭像</label>
                                <div class="avatar-upload">
                                    <div class="avatar-preview">
                                        <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Ming" alt="Avatar">
                                    </div>
                                    <div class="avatar-actions">
                                        <button type="button" class="btn btn-ghost">
                                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12" stroke-width="2" stroke-linecap="round"/>
                                            </svg>
                                            <span data-i18n="settings.uploadAvatar">上傳新圖片</span>
                                        </button>
                                        <button type="button" class="btn btn-ghost">
                                            <span data-i18n="settings.removeAvatar">移除</span>
                                        </button>
                                    </div>
                                </div>
                                <small class="form-help" data-i18n="settings.avatarHelp">建議上傳 512x512 像素的圖片，檔案大小不超過 2MB</small>
                            </div>
                        </form>
                    </section>

                    <!-- Preferences -->
                    <section class="glass-card mb-6">
                        <h2 class="section-title" data-i18n="settings.preferences">偏好設定</h2>
                        <form class="settings-form">
                            <div class="form-group">
                                <label class="form-label" for="language" data-i18n="settings.language">語言</label>
                                <select id="language" class="form-input">
                                    <option value="zh-TW" selected>繁體中文</option>
                                    <option value="zh-CN">简体中文</option>
                                    <option value="en">English</option>
                                    <option value="ja">日本語</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label class="form-label" for="timezone" data-i18n="settings.timezone">時區</label>
                                <select id="timezone" class="form-input">
                                    <option value="Asia/Taipei" selected>台北 (GMT+8)</option>
                                    <option value="Asia/Shanghai">上海 (GMT+8)</option>
                                    <option value="Asia/Tokyo">東京 (GMT+9)</option>
                                    <option value="America/New_York">紐約 (GMT-5)</option>
                                    <option value="Europe/London">倫敦 (GMT+0)</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label class="form-label" for="dateFormat" data-i18n="settings.dateFormat">日期格式</label>
                                <select id="dateFormat" class="form-input">
                                    <option value="YYYY-MM-DD" selected>2024-12-17</option>
                                    <option value="DD/MM/YYYY">17/12/2024</option>
                                    <option value="MM/DD/YYYY">12/17/2024</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label class="form-label" for="theme" data-i18n="settings.theme">主題</label>
                                <select id="theme" class="form-input">
                                    <option value="auto" selected>自動（跟隨系統）</option>
                                    <option value="light">淺色</option>
                                    <option value="dark">深色</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label class="form-checkbox">
                                    <input type="checkbox" checked>
                                    <span data-i18n="settings.emailNotifications">接收 Email 通知</span>
                                </label>
                            </div>

                            <div class="form-group">
                                <label class="form-checkbox">
                                    <input type="checkbox" checked>
                                    <span data-i18n="settings.pushNotifications">接收推播通知</span>
                                </label>
                            </div>

                            <div class="form-group">
                                <label class="form-checkbox">
                                    <input type="checkbox">
                                    <span data-i18n="settings.marketingEmails">接收產品與優惠資訊</span>
                                </label>
                            </div>
                        </form>
                    </section>

                    <!-- API Settings -->
                    <section class="glass-card mb-6">
                        <h2 class="section-title" data-i18n="settings.apiSettings">API 設定</h2>
                        <form class="settings-form">
                            <div class="form-group">
                                <label class="form-label" for="apiKey" data-i18n="settings.apiKey">API 金鑰</label>
                                <div class="input-group">
                                    <input type="password" id="apiKey" class="form-input" value="sk-1234567890abcdef" readonly>
                                    <button type="button" class="btn btn-ghost" id="copyApiKey">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                            <rect x="9" y="9" width="13" height="13" rx="2" stroke-width="2"/>
                                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" stroke-width="2"/>
                                        </svg>
                                    </button>
                                    <button type="button" class="btn btn-ghost" id="regenerateApiKey">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                            <path d="M21 2v6h-6M3 12a9 9 0 0 1 15-6.7L21 8M3 22v-6h6M21 12a9 9 0 0 1-15 6.7L3 16" stroke-width="2" stroke-linecap="round"/>
                                        </svg>
                                    </button>
                                </div>
                                <small class="form-help" data-i18n="settings.apiKeyHelp">請妥善保管您的 API 金鑰，不要與他人分享</small>
                            </div>

                            <div class="form-group">
                                <label class="form-label" data-i18n="settings.apiUsage">API 使用量</label>
                                <div class="usage-stats">
                                    <div class="usage-item">
                                        <span class="usage-label" data-i18n="settings.thisMonth">本月使用</span>
                                        <span class="usage-value">8,542 / 10,000</span>
                                    </div>
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: 85.42%"></div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </section>

                    <!-- Save Actions -->
                    <div class="settings-actions">
                        <button type="button" class="btn btn-ghost" data-i18n="settings.cancel">取消</button>
                        <button type="submit" class="btn btn-primary" data-i18n="settings.save">儲存變更</button>
                    </div>
                </div>
            </div>
        </div>
        </main>
    </div>

    <!-- JavaScript -->
    <script type="module">
        import { initTheme } from '../js/theme.js';
        import { initI18n } from '../js/i18n.js';
        import { render as renderSidebar } from '../js/components/sidebar.js';

        // Initialize
        initTheme();
        initI18n();

        // Shared sidebar
        const sidebarContainer = document.getElementById('sidebar-container');
        if (sidebarContainer) renderSidebar(sidebarContainer);

        // Lucide
        (async () => {
            const { initIcons } = await import('../js/lucide-icons.js');
            await initIcons();
        })();

        // Copy API Key
        document.getElementById('copyApiKey')?.addEventListener('click', async () => {
            const apiKey = document.getElementById('apiKey').value;
            await navigator.clipboard.writeText(apiKey);
            alert('API 金鑰已複製到剪貼簿');
        });

        // Regenerate API Key
        document.getElementById('regenerateApiKey')?.addEventListener('click', () => {
            if (confirm('確定要重新產生 API 金鑰嗎？舊的金鑰將會失效。')) {
                const newKey = 'sk-' + Math.random().toString(36).substring(2, 15);
                document.getElementById('apiKey').value = newKey;
                alert('API 金鑰已重新產生');
            }
        });

        // Save Settings
        document.querySelector('.btn-primary')?.addEventListener('click', (e) => {
            e.preventDefault();
            alert('設定已儲存！');
        });
    </script>
</body>
</html>
